# Implementation Specs

This document outlines the tactical changes required to implement the Advanced Sixpack Analysis Dashboard generated by Stitch.

## css/layout.css

### Action: Update Layout

Add new classes to support the Sixpack dashboard layout (grid + sidebar).

```css
/* Sixpack Dashboard Layout */
.sixpack-wrapper {
  display: grid;
  grid-template-columns: 2fr 1fr;
  gap: 20px;
  height: 100%;
  overflow: hidden;
}

.sixpack-charts {
  display: grid;
  grid-template-columns: 1fr 1fr;
  grid-template-rows: repeat(3, 1fr);
  gap: 16px;
  overflow-y: auto;
  padding-right: 8px;
}

.sixpack-sidebar {
  display: flex;
  flex-direction: column;
  gap: 16px;
  overflow-y: auto;
  padding-right: 8px;
}

.stat-card {
  background: #FFF;
  border: 1px solid var(--border-color);
  border-radius: 4px;
  overflow: hidden;
}

.stat-header {
  background: #F8F9FA;
  padding: 8px 12px;
  border-bottom: 1px solid var(--border-color);
  font-size: 0.75rem;
  font-weight: 600;
  text-transform: uppercase;
  color: var(--col-muted);
  letter-spacing: 0.5px;
}

.stat-body {
  padding: 16px;
  display: flex;
  flex-direction: column;
  gap: 12px;
}

.stat-row {
  display: flex;
  justify-content: space-between;
  align-items: center;
}

.stat-label {
  font-size: 0.85rem;
  color: var(--col-text-secondary);
  font-weight: 500;
}

.stat-value {
  font-family: 'IBM Plex Sans', monospace;
  font-weight: 600;
  font-size: 1rem;
  color: var(--col-text);
}

.stat-value.large {
  font-size: 1.5rem;
}

.stat-value.highlight {
  color: var(--col-primary);
}

.stat-value.success {
  color: #20B2AA;
}
```

## index.html

### Action: Replace Sixpack Tab Content

Replace the content of `<div id="t-six" class="tab-pane">` with the new structure.

```html
  <div id="t-six" class="tab-pane">
    <div class="sixpack-wrapper">
      <!-- Left Section: 6 Charts -->
      <div class="sixpack-charts">
        <div class="chart-container"><div class="chart-header">1. Carta I (Indiv.)</div><div id="six-1" class="plot-div"></div></div>
        <div class="chart-container"><div class="chart-header">2. Carta MR (Ampl.)</div><div id="six-3" class="plot-div"></div></div>
        <div class="chart-container"><div class="chart-header">3. Últimos 25</div><div id="six-5" class="plot-div"></div></div>
        <div class="chart-container"><div class="chart-header">4. Histograma Capabilidade</div><div id="six-2" class="plot-div"></div></div>
        <div class="chart-container"><div class="chart-header">5. Probabilidade Normal</div><div id="six-4" class="plot-div"></div></div>
        <div class="chart-container"><div class="chart-header">6. Plot Capabilidade</div><div id="six-6" class="plot-div"></div></div>
      </div>

      <!-- Right Section: Statistics Sidebar -->
      <div class="sixpack-sidebar">
        <!-- Process Data Card -->
        <div class="stat-card">
          <div class="stat-header">Dados do Processo</div>
          <div class="stat-body">
            <div class="stat-row">
              <span class="stat-label">Média</span>
              <span class="stat-value" id="sp-mean">-</span>
            </div>
            <div class="stat-row">
              <span class="stat-label">Amostra N</span>
              <span class="stat-value" id="sp-n">-</span>
            </div>
            <div style="border-top:1px solid #EEE; margin:4px 0;"></div>
            <div class="stat-row">
              <span class="stat-label">Desvio Padrão (Within)</span>
              <span class="stat-value" id="sp-swithin">-</span>
            </div>
            <div class="stat-row">
              <span class="stat-label">Desvio Padrão (Overall)</span>
              <span class="stat-value" id="sp-soverall">-</span>
            </div>
          </div>
        </div>

        <!-- Capability Card -->
        <div class="stat-card">
          <div class="stat-header">Capacidade (Curto Prazo)</div>
          <div class="stat-body">
            <div class="stat-row">
              <div style="display:flex; flex-direction:column;">
                <span class="stat-label">Cp</span>
                <span class="stat-value large success" id="sp-cp">-</span>
              </div>
              <div style="display:flex; flex-direction:column; text-align:right;">
                <span class="stat-label">Cpk</span>
                <span class="stat-value large success" id="sp-cpk">-</span>
              </div>
            </div>
            <div class="stat-row">
              <span class="stat-label">Cpk Inferior</span>
              <span class="stat-value" id="sp-cpk-l">-</span>
            </div>
            <div class="stat-row">
              <span class="stat-label">Cpk Superior</span>
              <span class="stat-value" id="sp-cpk-u">-</span>
            </div>
          </div>
        </div>

        <!-- Performance Card -->
        <div class="stat-card">
          <div class="stat-header">Performance (Global)</div>
          <div class="stat-body">
            <div class="stat-row">
              <div style="display:flex; flex-direction:column;">
                <span class="stat-label">Pp</span>
                <span class="stat-value large" id="sp-pp">-</span>
              </div>
              <div style="display:flex; flex-direction:column; text-align:right;">
                <span class="stat-label">Ppk</span>
                <span class="stat-value large highlight" id="sp-ppk">-</span>
              </div>
            </div>
            <div class="stat-row">
              <span class="stat-label">Cpm</span>
              <span class="stat-value" id="sp-cpm">-</span>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
```

## js/charts.js

### Action: Update `renderSixpack`

Modify `renderSixpack` to update the new statistics elements and adjust chart colors.

```javascript
export function renderSixpack() {
  const { data, stats, limits } = state;
  const { mean, sOverall, sWithin, cp, cpk, pp, ppk, cpm } = stats; // Ensure these are available
  const { ind } = limits;
  if(data.length < 10) return;

  // Populate Stats Sidebar
  const setVal = (id, val, digits=3) => {
      const el = document.getElementById(id);
      if(el) el.textContent = fmt(val, digits);
  };

  setVal('sp-mean', mean);
  setVal('sp-n', data.length, 0);
  setVal('sp-swithin', sWithin);
  setVal('sp-soverall', sOverall);
  setVal('sp-cp', cp);
  setVal('sp-cpk', cpk);
  // Assume cpkL/cpkU might need calculation or be in stats object. For now use cpk if not split.
  // Actually worker returns descStats? No, stats usually has these.
  // If not, we might need to calc them or leave as placeholder.
  // Let's assume standard stats object has them or just show main indices.

  setVal('sp-pp', pp);
  setVal('sp-ppk', ppk);
  setVal('sp-cpm', cpm);

  // Chart Rendering Logic (Updated Colors)
  const colorRed = '#ea2a33';
  const colorJade = '#20B2AA';

  // ... (Update Plotly.react calls with new colors)
  // Example for I-Chart:
  const layoutI = { margin:{t:20,b:20,l:30,r:10}, xaxis:{showticklabels:false}, yaxis:{showticklabels:false}, showlegend:false, separators:',.', shapes:[{type:'line', y0:ind.ucl, y1:ind.ucl, x0:0, x1:1, xref:'paper', line:{color:colorRed, width:1}},{type:'line', y0:ind.lcl, y1:ind.lcl, x0:0, x1:1, xref:'paper', line:{color:colorRed, width:1}}] };
  Plotly.react('six-1', [{ y: data, type:'scatter', mode:'lines', line:{color:colorJade, width:1} }], layoutI, plotlyConfig());

  // ... (Apply similar color updates to other charts)
}
```
